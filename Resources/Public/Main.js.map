{"version":3,"file":"Main.js","sources":["../Private/Assets/Main.js"],"sourcesContent":["const NAMESPACE = 'betterembed';\nconst SWITCH_CLASS = `js-${NAMESPACE}-switch`;\nconst CLOSE_CLASS = `js-${NAMESPACE}-close`;\nconst LOAD_REMOTE_CLASS = `js-${NAMESPACE}-load-remote`;\nconst REMOTE_VISIBLE_CLASS = `is-${NAMESPACE}-remote-visible`;\nconst SHOW_MESSAGE_CLASS = `is-${NAMESPACE}-dialog-visible`;\nconst CONFIRMED_MESSAGE_CLASS = `is-${NAMESPACE}-confirmed`;\n\nconst getContainer = element => element.closest(`.js-${NAMESPACE}`);\nconst getEmbedElement = container => container.querySelector(`.js-${NAMESPACE}-embed`);\n\ndocument.addEventListener('click', function(event) {\n    const TARGET = event.target;\n\n    if (TARGET.classList.contains(SWITCH_CLASS)) {\n        const CONTAINER = getContainer(TARGET);\n        const CLASS_LIST = CONTAINER.classList;\n        const ALREADY_CONFIRMED = CLASS_LIST.contains(CONFIRMED_MESSAGE_CLASS);\n\n        // toggle remote if already confirmed, otherwhise toggle message\n        CLASS_LIST.toggle(ALREADY_CONFIRMED ? REMOTE_VISIBLE_CLASS : SHOW_MESSAGE_CLASS);\n    }\n\n    if (TARGET.classList.contains(CLOSE_CLASS)) {\n        const CONTAINER = getContainer(TARGET);\n\n        // Hide Message\n        CONTAINER.classList.remove(SHOW_MESSAGE_CLASS);\n    }\n\n    if (TARGET.classList.contains(LOAD_REMOTE_CLASS)) {\n        const CONTAINER = getContainer(TARGET);\n        const CLASS_LIST = CONTAINER.classList;\n        const EMBED_ELEMENT = getEmbedElement(CONTAINER);\n\n        if (!EMBED_ELEMENT.innerHTML) {\n            // This is the first-time click\n            EMBED_ELEMENT.innerHTML = JSON.parse(CONTAINER.dataset.embedHtml);\n\n            // Run trough every script and active it\n            Array.from(EMBED_ELEMENT.querySelectorAll('script')).forEach(scriptTag => {\n                if (scriptTag.src) {\n                    const TAG = document.createElement('script');\n                    TAG.src = scriptTag.src;\n                    document.head.appendChild(TAG);\n                } else {\n                    // The script is an inline JS, so we have to use eval\n                    // jshint -W061\n                    window.eval(scriptTag.innerHTML);\n                    // jshint +W061\n                }\n            });\n        }\n        CLASS_LIST.add(REMOTE_VISIBLE_CLASS);\n        CLASS_LIST.add(CONFIRMED_MESSAGE_CLASS);\n        CLASS_LIST.remove(SHOW_MESSAGE_CLASS);\n    }\n});\n"],"names":["NAMESPACE","SWITCH_CLASS","CLOSE_CLASS","LOAD_REMOTE_CLASS","REMOTE_VISIBLE_CLASS","SHOW_MESSAGE_CLASS","CONFIRMED_MESSAGE_CLASS","getContainer","element","closest","document","addEventListener","event","TARGET","target","classList","contains","CLASS_LIST","ALREADY_CONFIRMED","toggle","remove","CONTAINER","EMBED_ELEMENT","querySelector","innerHTML","JSON","parse","dataset","embedHtml","Array","from","querySelectorAll","forEach","scriptTag","src","TAG","createElement","head","appendChild","window","eval","add"],"mappings":";;;;;;yBAAA,IAAMA,EAAY,cACZC,eAAqBD,aACrBE,eAAoBF,YACpBG,eAA0BH,kBAC1BI,eAA6BJ,qBAC7BK,eAA2BL,qBAC3BM,eAAgCN,gBAEhCO,EAAe,SAAAC,UAAWA,EAAQC,sBAAeT,KAGvDU,SAASC,iBAAiB,SAAS,SAASC,OAClCC,EAASD,EAAME,UAEjBD,EAAOE,UAAUC,SAASf,GAAe,KAEnCgB,EADYV,EAAaM,GACFE,UACvBG,EAAoBD,EAAWD,SAASV,GAG9CW,EAAWE,OAAOD,EAAoBd,EAAuBC,GAG7DQ,EAAOE,UAAUC,SAASd,IACRK,EAAaM,GAGrBE,UAAUK,OAAOf,MAG3BQ,EAAOE,UAAUC,SAASb,GAAoB,KACxCkB,EAAYd,EAAaM,GACzBI,EAAaI,EAAUN,UACvBO,EAAgCD,EAxBCE,4BAAqBvB,aA0BvDsB,EAAcE,YAEfF,EAAcE,UAAYC,KAAKC,MAAML,EAAUM,QAAQC,WAGvDC,MAAMC,KAAKR,EAAcS,iBAAiB,WAAWC,SAAQ,SAAAC,MACrDA,EAAUC,IAAK,KACTC,EAAMzB,SAAS0B,cAAc,UACnCD,EAAID,IAAMD,EAAUC,IACpBxB,SAAS2B,KAAKC,YAAYH,QAI1BI,OAAOC,KAAKP,EAAUT,eAKlCP,EAAWwB,IAAIrC,GACfa,EAAWwB,IAAInC,GACfW,EAAWG,OAAOf"}